<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CAPTUA NUMEROS DE SERIE</title>

  <!-- Tus estilos existentes -->
  <link rel="stylesheet" href="/css/formatoB.css" />
  <link rel="stylesheet" href="/css/escaneo.css" />

  <!-- Librerías -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css"/>
  <script src="/js/sweetalert-controller.js"></script>
</head>

<body>
  <!-- HEADER FIJO - ESTO ES LO QUE FALTABA -->
  <div class="app-header">
    <div class="top-right">
      <img src="/img/usuario.webp" alt="Usuario" class="user-icon" />
      <div class="username" id="username-display">Usuario</div>
      <div class="user-info">
        <div class="logout-container">
          <i class="fas fa-right-from-bracket logout-icon" id="logout-icon" title="Cerrar sesión"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- CONTENEDOR PRINCIPAL - ESTO TAMBIÉN FALTABA -->
  <div class="app-container">
    <!-- CONTENEDOR DE CONTENIDO - Y ESTO TAMBIÉN -->
    <div class="content-container">
      
      <!-- Sección del formulario -->
      <div class="form-section">
        <h1>4K ALEXA - 73488</h1>

        <!-- Instrucciones -->
        <div class="instrucciones">
          <p><strong>Instrucciones:</strong></p>
          <ul>
            <li>Escanee o ingrese el número de serie (S/N).</li>
            <li>Para SCRAP: <strong> active botón (ON)</strong> y <strong>un motivo.</strong></li>
          </ul>
        </div>
        
        <div class="form-group">
          <label class="required">S/N</label>
          <input type="text" id="sn-input" placeholder="Ingrese el número de serie" />
        </div>

        <!-- Motivo de Scrap -->
        <div class="form-group motivo-scrap-group">
          <input type="text" id="scrap-input" name="scrap" hidden />
          <label class="required" for="motivo-scrap">Motivo de Scrap</label>
          <select id="motivo-scrap" name="motivoScrap">
            <option value="">Seleccione un motivo</option>
            <option value="cosmetica">Cosmética</option>
            <option value="electronica">Electrónica</option>
            <option value="infestado">Infestado</option>
          </select>
        </div>

        <!-- Botón SCRAP ON/OFF -->
        <button class="btn-toggle is-off" id="autoenter-toggle" title="SCRAP desactivado">
          <i class="fas fa-keyboard"></i> SCRAP: OFF
        </button>

        <!-- Botón Guardar -->
        <button class="btn-confirmar" id="guardar-btn">
          <i class="fas fa-save"></i> GUARDAR REGISTRO
        </button>

        <div class="status-indicator"><span class="ready">Listo para escanear</span></div>

        <button id="volver-btn" class="btn-secondary">
          <i class="fas fa-arrow-left"></i> Volver
        </button>

        <button class="btn-completar" id="finalizar-lote-btn" style="display: none;">
          <i class="fas fa-check-double"></i> FINALIZAR LOTE
        </button>
      </div>

      <!-- Sección de la tabla -->
      <div class="table-section">
        <h1>Historial de Registros</h1>

        <!-- Barra de búsqueda -->
        <div class="historial-search">
          <div class="search-bar">
            <i class="fas fa-search search-icon" aria-hidden="true"></i>
            <input
              type="text"
              id="historial-search"
              class="search-input"
              placeholder="Buscar en historial (usuario, N/S, fecha, registro, tipo)…"
              autocomplete="off"
              aria-label="Buscar en historial de registros"
            />
            <button type="button" id="clear-search" class="clear-btn" aria-label="Limpiar búsqueda">
              Limpiar
            </button>
            <span id="search-count" class="search-count" aria-live="polite"></span>
          </div>
        </div>

        <div class="table-container">
          <table class="registros-table">
            <thead>
              <tr>
                <th>ID (Usuario)</th>
                <th>N/S</th>
                <th>Fecha</th>
                <th>Registro</th>
                <th>Tipo</th>
              </tr>
            </thead>
            <tbody id="registros-body">
              <!-- Aquí van los registros dinámicos -->
              <tr>
                <td>Usuario Ejemplo</td>
                <td>123456789</td>
                <td>2024-01-01 12:00:00</td>
                <td>REGISTRADO</td>
                <td>N/A</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
    </div>
  </div>

  <!-- Librerías -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- Scripts existentes -->
  <script src="/js/cerrarsesion.js"></script>
  <script src="/js/formato-captura.js"></script>
  <script src="/js/scrap-toggle.js" defer></script>
  <script src="/js/historial-search.js" defer></script>

  <!-- Inicialización -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      window.user = window.user || { userName: 'REGISTRO' };
      
      // Actualizar el texto del header
      const usernameDisplay = document.getElementById('username-display');
      if (usernameDisplay) {
        usernameDisplay.textContent = 'REGISTRO';
      }
      
      const volverBtn = document.getElementById('volver-btn');
      if (volverBtn) volverBtn.addEventListener('click', () => window.history.back());
    });
  </script>
</body>
</html>